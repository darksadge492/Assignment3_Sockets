<!DOCTYPE html>
<html>
    <head>
        <title>Competitive</title>
        <meta charset="utf-8" />
        <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
        <script src="/socket.io/socket.io.js"></script>

        <script>
            AFRAME.registerComponent('experience-manager', {
                init: function () {
                    //VARIBALES FOR CARD FLIPPING(BOOLEANS)
                    const socket        = io();
                    const tictacArray   = ['_','_','_','_','_','_','_','_','_'];
                    var team            = "_";
                    var flipped1        = false;
                    var flipped2        = true;
                    var flipped3        = false;
                    var flipped4        = true;
                    var flipped5        = false;
                    var flipped6        = true;
                    var flipped7        = false;
                    var flipped8        = true;
                    var flipped9        = false;

                    socket.on('connect', (userData) => {
                    console.log('I exist!');
                    console.log(tictacArray);

                        //put code here so that we know that socket.io has initailized ...
                        document.querySelector('#reset_button').addEventListener('click', function(){
                            socket.emit('reset');
                        });

                        document.querySelector('#X_button').addEventListener('click', function(){
                            team = "X";
                        });

                        document.querySelector('#O_button').addEventListener('click', function(){
                            team = "O";
                        });

                        document.querySelector('#card_1').addEventListener('click', function(){
                            socket.emit('pressSquareOne');
                        });

                        document.querySelector('#card_2').addEventListener('click', function(){
                            socket.emit('pressSquareTwo');
                        });

                        document.querySelector('#card_3').addEventListener('click', function(){
                            socket.emit('pressSquareThree');
                        });

                        document.querySelector('#card_4').addEventListener('click', function(){
                            socket.emit('pressSquareFour');
                        });

                        document.querySelector('#card_5').addEventListener('click', function(){
                            socket.emit('pressSquareFive');
                        });

                        document.querySelector('#card_6').addEventListener('click', function(){
                            socket.emit('pressSquareSix');
                        });

                        document.querySelector('#card_7').addEventListener('click', function(){
                            socket.emit('pressSquareSeven');
                        });

                        document.querySelector('#card_8').addEventListener('click', function(){
                            socket.emit('pressSquareEight');
                        });

                        document.querySelector('#card_9').addEventListener('click', function(){
                            socket.emit('pressSquareNine');
                        });
                    });

                    socket.on('updateText', () => {
                        console.log("UPDATING TEXT!!!");
                        let arrayLength = tictacArray.length;

                        for(let i = 0; i < arrayLength; i++){
                            switch(i){
                                case 0:
                                    document.querySelector('#box1Text').setAttribute('value', tictacArray[i]);
                                    console.log(i);
                                    break;
                                case 1:
                                    document.querySelector('#box2Text').setAttribute('value', tictacArray[i]);
                                    console.log(i);
                                    break;
                                case 2:
                                    document.querySelector('#box3Text').setAttribute('value', tictacArray[i]);
                                    console.log(i);
                                    break;
                                case 3:
                                    document.querySelector('#box4Text').setAttribute('value', tictacArray[i]);
                                    console.log(i);
                                    break;
                                case 4:
                                    document.querySelector('#box5Text').setAttribute('value', tictacArray[i]);
                                    console.log(i);
                                    break;
                                case 5:
                                    document.querySelector('#box6Text').setAttribute('value', tictacArray[i]);
                                    console.log(i);
                                    break;
                                case 6:
                                    document.querySelector('#box7Text').setAttribute('value', tictacArray[i]);
                                    console.log(i);
                                    break;
                                case 7:
                                    document.querySelector('#box8Text').setAttribute('value', tictacArray[i]);
                                    console.log(i);
                                    break;
                                case 8:
                                    document.querySelector('#box9Text').setAttribute('value', tictacArray[i]);
                                    console.log(i);
                                    break;
                                default:
                                    console.log("UPDATE TEXT ERROR");
                                    break;
                            }
                                
                        }
                    });

                    //RESET TIC TAC TOE
                    socket.on('reset_tictactoe', () => {
                        tictacArray.fill("_");
                        console.log(team);
                        team = "_";
                        console.log(tictacArray);
                        socket.emit('updateText');
                        console.log('RESETTING TIC TAC TOE!!!');
                        document.querySelector('#TeamXWinTextPlane').setAttribute('visible', false);
                        document.querySelector('#TeamOWinTextPlane').setAttribute('visible', false);
                    });

                    socket.on('press_ONE', () => {
                        tictacArray[0] = team;
                        console.log(tictacArray);
                        socket.emit('updateText');
                        socket.emit('Xwin_Check');
                        socket.emit('Owin_Check');
                    });

                    socket.on('press_TWO', () => {
                        tictacArray[1] = team;
                        console.log(tictacArray);
                        socket.emit('updateText');
                        socket.emit('Xwin_Check');
                        socket.emit('Owin_Check');
                    });

                    socket.on('press_THREE', () => {
                        tictacArray[2] = team;
                        console.log(tictacArray);
                        socket.emit('updateText');
                        socket.emit('Xwin_Check');
                        socket.emit('Owin_Check');
                    });

                    socket.on('press_FOUR', () => {
                        tictacArray[3] = team;
                        console.log(tictacArray);
                        socket.emit('updateText');
                        socket.emit('Xwin_Check');
                        socket.emit('Owin_Check');
                    });

                    socket.on('press_FIVE', () => {
                        tictacArray[4] = team;
                        console.log(tictacArray);
                        socket.emit('updateText');
                        socket.emit('Xwin_Check');
                        socket.emit('Owin_Check');
                    });

                    socket.on('press_SIX', () => {
                        tictacArray[5] = team;
                        console.log(tictacArray);
                        socket.emit('updateText');
                        socket.emit('Xwin_Check');
                        socket.emit('Owin_Check');
                    });

                    socket.on('press_SEVEN', () => {
                        tictacArray[6] = team;
                        console.log(tictacArray);
                        socket.emit('updateText');
                        socket.emit('Xwin_Check');
                        socket.emit('Owin_Check');
                    });

                    socket.on('press_EIGHT', () => {
                        tictacArray[7] = team;
                        console.log(tictacArray);
                        socket.emit('updateText');
                        socket.emit('Xwin_Check');
                        socket.emit('Owin_Check');
                    });

                    socket.on('press_NINE', () => {
                        tictacArray[8] = team;
                        console.log(tictacArray);
                        socket.emit('updateText');
                        socket.emit('Xwin_Check');
                        socket.emit('Owin_Check');
                    });

                    socket.on('Xwin_Check', () => {
                        if(tictacArray[0] == 'X' && tictacArray[1] == 'X' && tictacArray[2] == 'X'){
                            document.querySelector('#TeamXWinTextPlane').setAttribute('visible', true);
                        }else if(tictacArray[3] == 'X' && tictacArray[4] == 'X' && tictacArray[5] == 'X'){
                            document.querySelector('#TeamXWinTextPlane').setAttribute('visible', true);
                        }else if(tictacArray[6] == 'X' && tictacArray[7] == 'X' && tictacArray[8] == 'X'){
                            document.querySelector('#TeamXWinTextPlane').setAttribute('visible', true);
                        }else if(tictacArray[0] == 'X' && tictacArray[3] == 'X' && tictacArray[6] == 'X'){
                            document.querySelector('#TeamXWinTextPlane').setAttribute('visible', true);
                        }else if(tictacArray[1] == 'X' && tictacArray[4] == 'X' && tictacArray[7] == 'X'){
                            document.querySelector('#TeamXWinTextPlane').setAttribute('visible', true);
                        }else if(tictacArray[2] == 'X' && tictacArray[5] == 'X' && tictacArray[8] == 'X'){
                            document.querySelector('#TeamXWinTextPlane').setAttribute('visible', true);
                        }else if(tictacArray[0] == 'X' && tictacArray[4] == 'X' && tictacArray[8] == 'X'){
                            document.querySelector('#TeamXWinTextPlane').setAttribute('visible', true);
                        }else if(tictacArray[6] == 'X' && tictacArray[4] == 'X' && tictacArray[2] == 'X'){
                            document.querySelector('#TeamXWinTextPlane').setAttribute('visible', true);
                        }
                    });

                    socket.on('Owin_Check', () => {
                        if(tictacArray[0] == 'O' && tictacArray[1] == 'O' && tictacArray[2] == 'O'){
                            document.querySelector('#TeamOWinTextPlane').setAttribute('visible', true);
                        }else if(tictacArray[3] == 'O' && tictacArray[4] == 'O' && tictacArray[5] == 'O'){
                            document.querySelector('#TeamOWinTextPlane').setAttribute('visible', true);
                        }else if(tictacArray[6] == 'O' && tictacArray[7] == 'O' && tictacArray[8] == 'O'){
                            document.querySelector('#TeamOWinTextPlane').setAttribute('visible', true);
                        }else if(tictacArray[0] == 'O' && tictacArray[3] == 'O' && tictacArray[6] == 'O'){
                            document.querySelector('#TeamOWinTextPlane').setAttribute('visible', true);
                        }else if(tictacArray[1] == 'O' && tictacArray[4] == 'O' && tictacArray[7] == 'O'){
                            document.querySelector('#TeamOWinTextPlane').setAttribute('visible', true);
                        }else if(tictacArray[2] == 'O' && tictacArray[5] == 'O' && tictacArray[8] == 'O'){
                            document.querySelector('#TeamOWinTextPlane').setAttribute('visible', true);
                        }else if(tictacArray[0] == 'O' && tictacArray[4] == 'O' && tictacArray[8] == 'O'){
                            document.querySelector('#TeamOWinTextPlane').setAttribute('visible', true);
                        }else if(tictacArray[6] == 'O' && tictacArray[4] == 'O' && tictacArray[2] == 'O'){
                            document.querySelector('#TeamOWinTextPlane').setAttribute('visible', true);
                        }
                    });

                }
            });
        </script>

    </head>

    <body>

        <a-scene experience-manager background="color:rgb(0, 0, 0);">
            <a-entity camera wasd-controls look-controls position="0 1.6 0">
                <a-entity cursor="rayOrigin:mouse;" raycaster="far:20; interval:200; objects:.interactive"></a-entity>
            </a-entity>

            <a-entity class="ground"  geometry="primitive:plane; width:14; height:14;" material="color:white;" position="0 0.01 0" rotation="-90 0 0"></a-entity>

            <!-- return button -->
            <a-entity id="return_button" position="-1 0.6 -3" rotation="0 0 0">
                <a-entity class="button interactive" position="0 0.6 0" geometry="primitive:cylinder; radius:0.15; height:0.2;" material="color:rgb(255, 100, 100)"
                            animation__mouseenter="property:material.color; type:color; to:rgb(255, 0, 0); startEvents:mouseenter; dur:200"
                            animation__mouseleave="property:material.color; type:color; to:rgb(255, 100, 100); startEvents:mouseleave; dur:200"
                            animation__click="property:position.y; from:0.55; to:0.6; startEvents:click; dur:300"
                            onclick="window.location.href = '/index.html';" shadow></a-entity>
                <a-entity position="0 0.3 0" geometry="primitive:box; width:0.5; depth:0.5; height:0.6;" material="color:rgb(255, 255, 255)" shadow>
                    <a-entity id="returnButtonTextPlane"  geometry="primitive:plane; width:1.9; height:0.3;" position="0 0 0.3" rotation="0 0 0" material="color:#000000;">
                        <a-text value="RETURN TO HOME"   position="-0.95 0 0"></a-text>
                    </a-entity>
                </a-entity>
            </a-entity>

            <!-- reset button -->
            <a-entity id="reset_button" position="1 0.6 -3" rotation="0 0 0">
                <a-entity class="button interactive" position="0 0.6 0" geometry="primitive:cylinder; radius:0.15; height:0.2;" material="color:rgb(255, 100, 100)"
                            animation__mouseenter="property:material.color; type:color; to:rgb(255, 0, 0); startEvents:mouseenter; dur:200"
                            animation__mouseleave="property:material.color; type:color; to:rgb(255, 100, 100); startEvents:mouseleave; dur:200"
                            animation__click="property:position.y; from:0.55; to:0.6; startEvents:click; dur:300" shadow></a-entity>
                <a-entity position="0 0.3 0" geometry="primitive:box; width:0.5; depth:0.5; height:0.6;" material="color:rgb(255, 255, 255)" shadow>
                    <a-entity id="resetButtonTextPlane"  geometry="primitive:plane; width:1.5; height:0.3;" position="0 0 0.3" rotation="0 0 0" material="color:#000000;">
                        <a-text value="RESET GAME"   position="-0.7 0 0"></a-text>
                    </a-entity>
                </a-entity>
            </a-entity>

            <!-- Team X: Button -->
            <a-entity id="X_button" position="-3 2 -4" rotation="90 30 0">
                <a-entity class="button interactive" position="0 0.6 0" geometry="primitive:cylinder; radius:0.15; height:0.2;" material="color:rgb(255, 100, 100)"
                            animation__mouseenter="property:material.color; type:color; to:rgb(255, 0, 0); startEvents:mouseenter; dur:200"
                            animation__mouseleave="property:material.color; type:color; to:rgb(255, 100, 100); startEvents:mouseleave; dur:200"
                            animation__click="property:position.y; from:0.55; to:0.6; startEvents:click; dur:300" shadow></a-entity>
                <a-entity position="0 0.3 0" geometry="primitive:box; width:0.5; depth:0.5; height:0.6;" material="color:rgb(255, 255, 255)" shadow>
                    <a-entity id="teamXTextPlane"  geometry="primitive:plane; width:1.9; height:0.3;" position="0.35 0.5 -0.3" rotation="-90 0 0" material="color:#000000;">
                        <a-text value="PICK: TEAM X"   position="-0.95 0 0"></a-text>
                    </a-entity>
                </a-entity>
            </a-entity>

            <!-- Team O: Button -->
            <a-entity id="O_button" position="3 2 -4" rotation="90 -30 0">
                <a-entity class="button interactive" position="0 0.6 0" geometry="primitive:cylinder; radius:0.15; height:0.2;" material="color:rgb(255, 100, 100)"
                            animation__mouseenter="property:material.color; type:color; to:rgb(255, 0, 0); startEvents:mouseenter; dur:200"
                            animation__mouseleave="property:material.color; type:color; to:rgb(255, 100, 100); startEvents:mouseleave; dur:200"
                            animation__click="property:position.y; from:0.55; to:0.6; startEvents:click; dur:300" shadow></a-entity>
                <a-entity position="0 0.3 0" geometry="primitive:box; width:0.5; depth:0.5; height:0.6;" material="color:rgb(255, 255, 255)" shadow>
                    <a-entity id="teamOTextPlane"  geometry="primitive:plane; width:1.9; height:0.3;" position="0.2 0.5 -0.3" rotation="-90 0 0" material="color:#000000;">
                        <a-text value="PICK: TEAM O"   position="-0.95 0 0"></a-text>
                    </a-entity>
                </a-entity>
            </a-entity>

            <!--Tic Tac Toe Board-->
            <a-entity id="tictactoe" position="-0.5 2 -4">
                <a-entity id="TicTacToeTextPlane"  geometry="primitive:plane; width:1.5; height:0.5;" position="0.85 1.5 0" rotation="0 0 0" material="color:#000000;">
                    <a-text value="TIC TAC TOE"   position="-1 0 0"></a-text>
                </a-entity>
<!--Corner-->   <a-entity id="card_1" class="card interactive" position="0 0 0"      geometry="primitive:box; width:0.5; depth:0.5; height:0.5;" material="color:#c2b280" shadow>
                    <a-entity geometry="primitive:plane; width:0.4; height:0.4;" position="0 0 0.3" rotation="0 0 0" material="color:#000000;">
                        <a-text id="box1Text" value="_"   position="-0.08 0 0"></a-text>
                    </a-entity>
                </a-entity>
<!--Bottom-->   <a-entity id="card_2" class="card interactive" position="0.5 0 0"    geometry="primitive:box; width:0.5; depth:0.5; height:0.5;" material="color:#224952" shadow>
                    <a-entity geometry="primitive:plane; width:0.4; height:0.4;" position="0 0 0.3" rotation="0 0 0" material="color:#000000;">
                        <a-text id="box2Text" value="_"   position="-0.08 0 0"></a-text>
                    </a-entity>
                </a-entity>
<!--Corner-->   <a-entity id="card_3" class="card interactive" position="1 0 0"      geometry="primitive:box; width:0.5; depth:0.5; height:0.5;" material="color:#c2b280" shadow>
                    <a-entity geometry="primitive:plane; width:0.4; height:0.4;" position="0 0 0.3" rotation="0 0 0" material="color:#000000;">
                        <a-text id="box3Text" value="_"   position="-0.08 0 0"></a-text>
                    </a-entity>
                </a-entity>
<!--Middle-->   <a-entity id="card_4" class="card interactive" position="0 0.5 0"    geometry="primitive:box; width:0.5; depth:0.5; height:0.5;" material="color:#224952" shadow>
                    <a-entity geometry="primitive:plane; width:0.4; height:0.4;" position="0 0 0.3" rotation="0 0 0" material="color:#000000;">
                        <a-text id="box4Text" value="_"   position="-0.08 0 0"></a-text>
                    </a-entity>
                </a-entity>
<!--Middle-->   <a-entity id="card_5" class="card interactive" position="0.5 0.5 0"  geometry="primitive:box; width:0.5; depth:0.5; height:0.5;" material="color:#c2b280" shadow>
                    <a-entity geometry="primitive:plane; width:0.4; height:0.4;" position="0 0 0.3" rotation="0 0 0" material="color:#000000;">
                        <a-text id="box5Text" value="_"   position="-0.08 0 0"></a-text>
                    </a-entity>
                </a-entity>
<!--Middle-->   <a-entity id="card_6" class="card interactive" position="1 0.5 0"    geometry="primitive:box; width:0.5; depth:0.5; height:0.5;" material="color:#224952" shadow>
                    <a-entity geometry="primitive:plane; width:0.4; height:0.4;" position="0 0 0.3" rotation="0 0 0" material="color:#000000;">
                        <a-text id="box6Text" value="_"   position="-0.08 0 0"></a-text>
                    </a-entity>
                </a-entity>
<!--Corner-->   <a-entity id="card_7" class="card interactive" position="0 1 0"      geometry="primitive:box; width:0.5; depth:0.5; height:0.5;" material="color:#c2b280" shadow>
                    <a-entity geometry="primitive:plane; width:0.4; height:0.4;" position="0 0 0.3" rotation="0 0 0" material="color:#000000;">
                        <a-text id="box7Text" value="_"   position="-0.08 0 0"></a-text>
                    </a-entity>
                </a-entity>
<!--Middle-->   <a-entity id="card_8" class="card interactive" position="0.5 1 0"    geometry="primitive:box; width:0.5; depth:0.5; height:0.5;" material="color:#224952" shadow>
                    <a-entity geometry="primitive:plane; width:0.4; height:0.4;" position="0 0 0.3" rotation="0 0 0" material="color:#000000;">
                        <a-text id="box8Text" value="_"   position="-0.08 0 0"></a-text>
                    </a-entity>
                </a-entity>
<!--Corner-->   <a-entity id="card_9" class="card interactive" position="1 1 0"      geometry="primitive:box; width:0.5; depth:0.5; height:0.5;" material="color:#c2b280" shadow>
                    <a-entity geometry="primitive:plane; width:0.4; height:0.4;" position="0 0 0.3" rotation="0 0 0" material="color:#000000;">
                        <a-text id="box9Text" value="_"   position="-0.08 0 0"></a-text>
                    </a-entity>
                </a-entity>
            </a-entity>



            <a-entity id="TeamXWinTextPlane"  geometry="primitive:plane; width:3; height:0.5;" position="-0.4 5 -5" rotation="0 0 0" material="color:#000000;" visible="false">
                <a-text value="TEAM X WINS!!! CONGRATULATIONS!!!"   position="-1.5 0 0"></a-text>
            </a-entity>

            <a-entity id="TeamOWinTextPlane"  geometry="primitive:plane; width:3; height:0.5;" position="-0.4 5 -5" rotation="0 0 0" material="color:#000000;" visible="false">
                <a-text value="TEAM O WINS!!! CONGRATULATIONS!!!"   position="-1.5 0 0"></a-text>
            </a-entity>

        </a-scene>
    </body>
</html>